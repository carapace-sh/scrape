# yaml-language-server: $schema=https://carapace.sh/schemas/command.json
name: devbox
description: Instant, easy, predictable development environments
persistentflags:
    --debug&: Show full stack traces on errors
    --trace&?: write a trace to a file
    -q, --quiet: suppresses logs
commands:
    - name: add <pkg>...
      description: Add a new package to your devbox
      flags:
        --allow-insecure*=: allow adding packages marked as insecure.
        --disable-plugin: disable plugin (if any) for this package.
        --environment=: environment to use, when supported (e.g.secrets support dev, prod, preview.)
        --patch-glibc&: patch any ELF binaries to use the latest glibc version in nixpkgs
        --patch=: allow Devbox to patch the package to fix known issues (auto, always, never)
        -c, --config=: path to directory containing a devbox.json config file
        -e, --exclude-platform*=: exclude packages from a specific platform.
        -o, --outputs*=: specify the outputs to select for the nix package
        -p, --platform*=: add packages to run on only this platform.
    - name: all
      description: List all commands, including hidden ones
      hidden: true
    - name: auth
      description: Devbox auth commands
      commands:
        - name: login
          description: Login to devbox
        - name: logout
          description: Logout from devbox
        - name: tokens
          description: Manage devbox auth tokens
          commands:
            - name: new
              description: Create a new token
        - name: whoami
          description: Show the current user
          flags:
            --show-tokens: Show the access, id, and refresh tokens
    - name: cache
      description: Collection of commands to interact with nix cache
      commands:
        - name: configure
          description: Configure Nix to use the Devbox cache as a substituter
          hidden: true
          flags:
            --user=: ""
        - name: credentials
          description: Output S3 cache credentials
          hidden: true
          flags:
            --format=: Output format, either json or sh
        - name: enable
          description: Enable the Devbox Nix cache for your account
        - name: info
          description: Output information about the nix cache
        - name: upload [installable]
          aliases:
            - copy
          description: upload specified or nix packages in current project to cache
          flags:
            --to=: URI of the cache to copy to
            -c, --config=: path to directory containing a devbox.json config file
    - name: completion
      description: Generate the autocompletion script for the specified shell
      commands:
        - name: bash
          description: Generate the autocompletion script for bash
          flags:
            --no-descriptions: disable completion descriptions
        - name: fish
          description: Generate the autocompletion script for fish
          flags:
            --no-descriptions: disable completion descriptions
        - name: powershell
          description: Generate the autocompletion script for powershell
          flags:
            --no-descriptions: disable completion descriptions
        - name: zsh
          description: Generate the autocompletion script for zsh
          flags:
            --no-descriptions: disable completion descriptions
    - name: create [dir] --template <template>
      description: Initialize a directory as a devbox project using a template
      flags:
        --show-all: show all available templates
        -r, --repo&=: 'Git repository HTTPS URL to import template files from. Example: https://github.com/jetify-com/devbox'
        -s, --subdir&=: 'Subdirectory of the Git repository in which the template files reside. Example: examples/tutorial'
        -t, --template=: template to initialize the project with
    - name: gen-docs <path>
      description: '[Internal] Generate documentation for the CLI'
      hidden: true
    - name: generate
      aliases:
        - gen
      description: Generate supporting files for your project
      flags:
        --environment=: environment to use, when supported (e.g.secrets support dev, prod, preview.)
        -c, --config=: path to directory containing a devbox.json config file
      commands:
        - name: alias
          description: Generate shell script aliases for this project
          flags:
            --environment=: environment to use, when supported (e.g.secrets support dev, prod, preview.)
            --no-prefix: Do not use a prefix for the generated aliases
            -c, --config=: path to directory containing a devbox.json config file
            -p, --prefix=: Prefix for the generated aliases
        - name: debug
          hidden: true
        - name: devcontainer
          description: Generate Dockerfile and devcontainer.json files under .devcontainer/ directory
          flags:
            --root-user: Use root as default user inside the container
            -f, --force: force overwrite on existing files
        - name: direnv
          description: Generate a .envrc file that integrates direnv with this devbox project
          flags:
            --environment=: environment to use, when supported (e.g.secrets support dev, prod, preview.)
            -c, --config=: path to directory containing a devbox.json config file
            -f, --force: force overwrite existing files
            -p, --print-envrc&: output contents of devbox configuration to use in .envrc
          persistentflags:
            --env-file=: path to a file containing environment variables to set in the devbox environment
            -e, --env=: environment variables to set in the devbox environment
        - name: dockerfile
          description: Generate a Dockerfile that replicates devbox shell
          flags:
            --environment=: environment to use, when supported (e.g.secrets support dev, prod, preview.)
            --for&=: Generate Dockerfile for a specific type of container (dev, prod)
            --root-user: Use root as default user inside the container
            -c, --config=: path to directory containing a devbox.json config file
            -f, --force: force overwrite existing files
        - name: readme [filename]
          description: Generate markdown readme file for this project
          flags:
            --environment=: environment to use, when supported (e.g.secrets support dev, prod, preview.)
            --save-template: Save default template for the README file
            -c, --config=: path to directory containing a devbox.json config file
            -t, --template=: Path to a custom template for the README file
    - name: global
      description: Manage global devbox packages
      commands:
        - name: add <pkg>...
          description: Add a new package to your devbox
          flags:
            --allow-insecure*=: allow adding packages marked as insecure.
            --disable-plugin: disable plugin (if any) for this package.
            --environment=: environment to use, when supported (e.g.secrets support dev, prod, preview.)
            --patch-glibc&: patch any ELF binaries to use the latest glibc version in nixpkgs
            --patch=: allow Devbox to patch the package to fix known issues (auto, always, never)
            -c, --config&=: path to directory containing a devbox.json config file
            -e, --exclude-platform*=: exclude packages from a specific platform.
            -o, --outputs*=: specify the outputs to select for the nix package
            -p, --platform*=: add packages to run on only this platform.
        - name: install
          description: Install all packages mentioned in devbox.json
          flags:
            --environment=: environment to use, when supported (e.g.secrets support dev, prod, preview.)
            --tidy-lockfile: Fix missing store paths in the devbox.lock file.
            -c, --config&=: path to directory containing a devbox.json config file
        - name: list
          aliases:
            - ls
          description: List installed packages
          flags:
            --environment=: environment to use, when supported (e.g.secrets support dev, prod, preview.)
            --outdated: List outdated packages
            -c, --config&=: path to directory containing a devbox.json config file
        - name: path
          description: Show path to [global] devbox config
          flags:
            --environment=: environment to use, when supported (e.g.secrets support dev, prod, preview.)
            -c, --config&=: path to directory containing a devbox.json config file
        - name: pull <file> | <url>
          description: Pull a config from a file or URL
          flags:
            --environment=: environment to use, when supported (e.g.secrets support dev, prod, preview.)
            -c, --config&=: path to directory containing a devbox.json config file
            -f, --force: Force overwrite of existing [global] config files
        - name: push <git-repo>
          description: Push a [global] config. Leave empty to use jetify cloud. Can be a git repo for self storage.
          flags:
            --environment=: environment to use, when supported (e.g.secrets support dev, prod, preview.)
            -c, --config&=: path to directory containing a devbox.json config file
        - name: rm <pkg>...
          description: Remove a package from your devbox
          flags:
            --environment=: environment to use, when supported (e.g.secrets support dev, prod, preview.)
            -c, --config&=: path to directory containing a devbox.json config file
        - name: run [<script> | <cmd>]
          description: Run a script or command in a shell with access to your packages
          flags:
            --all-projects: run command in all projects in the working directory, recursively. If command is not found in any project, it will be skipped.
            --environment=: environment to use, when supported (e.g.secrets support dev, prod, preview.)
            --omit-nix-env&: shell environment will omit the env-vars from print-dev-env
            --pure: if this flag is specified, devbox runs the script in an isolated environment inheriting almost no variables from the current environment. A few variables, in particular HOME, USER and DISPLAY, are retained.
            --recompute: recompute environment if needed
            -c, --config&=: path to directory containing a devbox.json config file
            -l, --list: list all scripts defined in devbox.json
          persistentflags:
            --env-file=: path to a file containing environment variables to set in the devbox environment
            -e, --env=: environment variables to set in the devbox environment
        - name: services
          description: Interact with devbox services.
          persistentflags:
            --env-file=: path to a file containing environment variables to set in the devbox environment
            --environment=: environment to use, when supported (e.g. secrets support dev, prod, preview.)
            --run-in-current-shell&: run the command in the current shell instead of a new shell
            -c, --config=: path to directory containing a devbox.json config file
            -e, --env=: environment variables to set in the devbox environment
          commands:
            - name: attach
              description: Attach to a running process-compose for the current project
            - name: ls
              description: List available services
            - name: restart [service]...
              description: Restart service. If no service is specified, restarts all services
            - name: start [service]...
              description: Start service. If no service is specified, starts all services
            - name: stop [service]...
              aliases:
                - down
              description: Stop one or more services in the current project. If no service is specified, stops all services in the current project.
              flags:
                --all-projects: |-
                    stop all running services across all your projects.
                    This flag cannot be used simultaneously with the [services] argument
            - name: up [service]...
              description: Starts process manager with specified services. If no services are listed, starts the process manager with all the services in your project
              flags:
                --pcflags*=: pass flags directly to process compose
                --process-compose-file=: path to process compose file or directory containing process compose-file.yaml|yml. Default is directory containing devbox.json
                -b, --background: run service in background
                -p, --pcport=: specify the port for process-compose to use. You can also set the pcport by exporting DEVBOX_PC_PORT_NUM
        - name: shellenv
          description: Print shell commands that create a Devbox Environment in the shell
          flags:
            --environment=: environment to use, when supported (e.g.secrets support dev, prod, preview.)
            --init-hook: runs init hook after exporting shell environment
            --install: install packages before exporting shell environment
            --no-refresh-alias&: by default, devbox will add refresh alias to the environmentUse this flag to disable this behavior.
            --omit-nix-env&: shell environment will omit the env-vars from print-dev-env
            --preserve-path-stack&: preserves existing PATH order if this project's environment is already in PATH. Useful if you want to avoid overshadowing another devbox project that is already active
            --pure: if this flag is specified, devbox creates an isolated environment inheriting almost no variables from the current environment. A few variables, in particular HOME, USER and DISPLAY, are retained.
            -c, --config&=: path to directory containing a devbox.json config file
            -r, --recompute: Recompute environment if needed
          persistentflags:
            --env-file=: path to a file containing environment variables to set in the devbox environment
            -e, --env=: environment variables to set in the devbox environment
        - name: update [pkg]...
          description: Update packages in your devbox
          flags:
            --all-projects: update all projects in the working directory, recursively.
            --environment=: environment to use, when supported (e.g.secrets support dev, prod, preview.)
            --no-install: update lockfile but don't install anything
            --sync-lock: sync all devbox.lock dependencies in multiple projects. Dependencies will sync to the latest local version.
            -c, --config&=: path to directory containing a devbox.json config file
    - name: help [command]
      description: Help about any command
    - name: info <pkg>
      description: Display package info
      flags:
        --environment=: environment to use, when supported (e.g.secrets support dev, prod, preview.)
        --markdown: output in markdown format
        -c, --config=: path to directory containing a devbox.json config file
    - name: init [<dir>]
      description: Initialize a directory as a devbox project
      flags:
        --auto&: Automatically detect packages to add
        --dry-run&: Dry run for auto mode. Prints the config that would be used
    - name: install
      description: Install all packages mentioned in devbox.json
      flags:
        --environment=: environment to use, when supported (e.g.secrets support dev, prod, preview.)
        --tidy-lockfile: Fix missing store paths in the devbox.lock file.
        -c, --config=: path to directory containing a devbox.json config file
    - name: integrate
      description: integrate with an IDE
      hidden: true
      commands:
        - name: vscode
          description: Integrate devbox environment with VSCode or other VSCode-based editors.
          hidden: true
          flags:
            --debugmode: enable debug outputs to a file.
            --environment=: environment to use, when supported (e.g.secrets support dev, prod, preview.)
            --ide=: name of the currently open editor to reopen after it's closed.
            -c, --config=: path to directory containing a devbox.json config file
    - name: list
      aliases:
        - ls
      description: List installed packages
      flags:
        --environment=: environment to use, when supported (e.g.secrets support dev, prod, preview.)
        --outdated: List outdated packages
        -c, --config=: path to directory containing a devbox.json config file
    - name: log <event-name> [<event-specific-args>]
      hidden: true
    - name: patch <store-path>
      description: Apply Devbox patches to a package to fix common linker errors
      hidden: true
      flags:
        --gcc=: patch binaries to use a different gcc
        --glibc=: patch binaries to use a different glibc
        --restore-refs: restore references to removed store paths
    - name: rm <pkg>...
      description: Remove a package from your devbox
      flags:
        --environment=: environment to use, when supported (e.g.secrets support dev, prod, preview.)
        -c, --config=: path to directory containing a devbox.json config file
    - name: run [<script> | <cmd>]
      description: Run a script or command in a shell with access to your packages
      flags:
        --all-projects: run command in all projects in the working directory, recursively. If command is not found in any project, it will be skipped.
        --environment=: environment to use, when supported (e.g.secrets support dev, prod, preview.)
        --omit-nix-env&: shell environment will omit the env-vars from print-dev-env
        --pure: if this flag is specified, devbox runs the script in an isolated environment inheriting almost no variables from the current environment. A few variables, in particular HOME, USER and DISPLAY, are retained.
        --recompute: recompute environment if needed
        -c, --config=: path to directory containing a devbox.json config file
        -l, --list: list all scripts defined in devbox.json
      persistentflags:
        --env-file=: path to a file containing environment variables to set in the devbox environment
        -e, --env=: environment variables to set in the devbox environment
    - name: search <pkg>
      description: Search for nix packages
      flags:
        --show-all: show all available templates
    - name: secrets
      aliases:
        - envsec
      description: Interact with devbox secrets in jetify cloud.
      persistentflags:
        --environment=: environment to use, when supported (e.g. secrets support dev, prod, preview.)
        -c, --config=: path to directory containing a devbox.json config file
      commands:
        - name: download <file1>
          description: Download environment variables into the specified file
          flags:
            -f, --format=: 'file format: dotenv or json'
        - name: init
          description: Initialize secrets management with jetify cloud
          flags:
            -f, --force: Force initialization even if already initialized
        - name: list
          aliases:
            - ls
          description: List all secrets
          flags:
            -f, --format=: 'Display the key values of each secret in the specified format, one of: table | dotenv | json.'
            -s, --show: Display secret values in plaintext
        - name: remove <NAME1> [<NAME2>]...
          aliases:
            - rm
          description: Remove one or more environment variables
        - name: set <NAME1>=<value1> [<NAME2>=<value2>]...
          description: Securely store one or more environment variables
        - name: upload <file1> [<fileN>]...
          description: Upload variables defined in one or more .env files.
          flags:
            -f, --format=: 'File format: dotenv or json'
    - name: services
      description: Interact with devbox services.
      persistentflags:
        --env-file=: path to a file containing environment variables to set in the devbox environment
        --environment=: environment to use, when supported (e.g. secrets support dev, prod, preview.)
        --run-in-current-shell&: run the command in the current shell instead of a new shell
        -c, --config=: path to directory containing a devbox.json config file
        -e, --env=: environment variables to set in the devbox environment
      commands:
        - name: attach
          description: Attach to a running process-compose for the current project
        - name: ls
          description: List available services
        - name: restart [service]...
          description: Restart service. If no service is specified, restarts all services
        - name: start [service]...
          description: Start service. If no service is specified, starts all services
        - name: stop [service]...
          aliases:
            - down
          description: Stop one or more services in the current project. If no service is specified, stops all services in the current project.
          flags:
            --all-projects: |-
                stop all running services across all your projects.
                This flag cannot be used simultaneously with the [services] argument
        - name: up [service]...
          description: Starts process manager with specified services. If no services are listed, starts the process manager with all the services in your project
          flags:
            --pcflags*=: pass flags directly to process compose
            --process-compose-file=: path to process compose file or directory containing process compose-file.yaml|yml. Default is directory containing devbox.json
            -b, --background: run service in background
            -p, --pcport=: specify the port for process-compose to use. You can also set the pcport by exporting DEVBOX_PC_PORT_NUM
    - name: setup
      description: Setup devbox dependencies
      hidden: true
      commands:
        - name: nix
          description: Install Nix
          flags:
            --daemon: Install Nix in multi-user mode. This flag is not supported if you are using DetSys installer
    - name: shell
      description: Start a new shell with access to your packages
      flags:
        --environment=: environment to use, when supported (e.g.secrets support dev, prod, preview.)
        --omit-nix-env&: shell environment will omit the env-vars from print-dev-env
        --print-env: print script to setup shell environment
        --pure: if this flag is specified, devbox creates an isolated shell inheriting almost no variables from the current environment. A few variables, in particular HOME, USER and DISPLAY, are retained.
        --recompute: recompute environment if needed
        -c, --config=: path to directory containing a devbox.json config file
      persistentflags:
        --env-file=: path to a file containing environment variables to set in the devbox environment
        -e, --env=: environment variables to set in the devbox environment
    - name: shellenv
      description: Print shell commands that create a Devbox Environment in the shell
      flags:
        --environment=: environment to use, when supported (e.g.secrets support dev, prod, preview.)
        --init-hook: runs init hook after exporting shell environment
        --install: install packages before exporting shell environment
        --no-refresh-alias&: by default, devbox will add refresh alias to the environmentUse this flag to disable this behavior.
        --omit-nix-env&: shell environment will omit the env-vars from print-dev-env
        --preserve-path-stack&: preserves existing PATH order if this project's environment is already in PATH. Useful if you want to avoid overshadowing another devbox project that is already active
        --pure: if this flag is specified, devbox creates an isolated environment inheriting almost no variables from the current environment. A few variables, in particular HOME, USER and DISPLAY, are retained.
        -c, --config=: path to directory containing a devbox.json config file
        -r, --recompute: Recompute environment if needed
      persistentflags:
        --env-file=: path to a file containing environment variables to set in the devbox environment
        -e, --env=: environment variables to set in the devbox environment
    - name: update [pkg]...
      description: Update packages in your devbox
      flags:
        --all-projects: update all projects in the working directory, recursively.
        --environment=: environment to use, when supported (e.g.secrets support dev, prod, preview.)
        --no-install: update lockfile but don't install anything
        --sync-lock: sync all devbox.lock dependencies in multiple projects. Dependencies will sync to the latest local version.
        -c, --config=: path to directory containing a devbox.json config file
    - name: version
      description: Print version information
      flags:
        -v, --verbose: displays additional version information
      commands:
        - name: update
          description: Update devbox launcher and binary
